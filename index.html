<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8" />
  <title>Mofutan Game</title>
  <!-- Phaser CDN（Phaser 3本体） -->
  <script src="https://cdn.jsdelivr.net/npm/phaser@3/dist/phaser.min.js"></script>
  <style>
    body { margin: 0; padding: 0; }
    #game-container { width: 100%; height: 100vh; }
  </style>
</head>
<body>
  <div id="game-container"></div>

  <script>
    // Phaserゲーム全体の設定
    const config = {
      type: Phaser.AUTO,
      width: 800,
      height: 600,
      parent: 'game-container',
      scene: {
        preload: preload,
        create: create,
        update: update
      }
    };

    // ゲームインスタンスを作成
    const game = new Phaser.Game(config);

    let mofutanSprite;    // キャラクター用
    let dialogText;       // 会話テキスト用
    let dialogVisible = false; // テキストが表示中かどうか

    //========================
    //  1) 画像を読み込む
    //========================
    function preload() {
      // 'mofutan' = キー名, 'assets/mofutan.png' = 実際のパス
      this.load.image('mofutan', 'assets/mofutan.png');
    }

    //===================================
    // 2) create()：シーンが生成される
    //===================================
    function create() {
      // 背景色 (お好みで変更可能)
      this.cameras.main.setBackgroundColor('#fceacd');

      // キャラを中央に配置し、スケールを少し小さく
      mofutanSprite = this.add.image(400, 300, 'mofutan').setScale(0.8);

      // クリック(タップ)判定をONにする
      mofutanSprite.setInteractive();

      //====================================
      // 会話テキスト(最初は非表示)
      //====================================
      dialogText = this.add.text(100, 500, '', {
        fontSize: '28px',
        color: '#000',
        backgroundColor: '#fff',
        padding: { x: 10, y: 5 }
      });
      dialogText.setVisible(false);

      //===========================
      // 3) クリックで会話表示
      //===========================
      mofutanSprite.on('pointerdown', () => {
        if (!dialogVisible) {
          dialogText.setText('もふたんだよ、よろしくね！');
          dialogText.setVisible(true);
          dialogVisible = true;
        } else {
          dialogText.setVisible(false);
          dialogVisible = false;
        }
      });
    }

    //===========================================
    // 3) update()：毎フレーム呼ばれる処理
    //    (キャラをゆらゆら揺らす)
    //===========================================
    function update(time, delta) {
      if (mofutanSprite) {
        // キャラを上下に揺らす
        mofutanSprite.y = 300 + Math.sin(time * 0.005) * 10;
        // ほんの少し角度を揺らす
        mofutanSprite.angle = Math.sin(time * 0.01) * 3;
      }
    }
  </script>
</body>
</html>
